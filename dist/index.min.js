"use strict";(function(){var _=function(s,o){return function(){return o||s((o={exports:{}}).exports,o),o.exports}};var M=_(function(D,S){(function(s,o){typeof D=="object"&&typeof S!="undefined"?o(D):typeof define=="function"&&define.amd?define(["exports"],o):o(s.WHATWGFetch={})})(D,function(s){"use strict";var o=typeof globalThis!="undefined"&&globalThis||typeof self!="undefined"&&self||typeof o!="undefined"&&o,n={searchParams:"URLSearchParams"in o,iterable:"Symbol"in o&&"iterator"in Symbol,blob:"FileReader"in o&&"Blob"in o&&function(){try{return new Blob,!0}catch(e){return!1}}(),formData:"FormData"in o,arrayBuffer:"ArrayBuffer"in o};function u(e){return e&&DataView.prototype.isPrototypeOf(e)}if(n.arrayBuffer)var a=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],i=ArrayBuffer.isView||function(e){return e&&a.indexOf(Object.prototype.toString.call(e))>-1};function c(e){if(typeof e!="string"&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(e)||e==="")throw new TypeError('Invalid character in header field name: "'+e+'"');return e.toLowerCase()}function y(e){return typeof e!="string"&&(e=String(e)),e}function b(e){var r={next:function(){var f=e.shift();return{done:f===void 0,value:f}}};return n.iterable&&(r[Symbol.iterator]=function(){return r}),r}function t(e){this.map={},e instanceof t?e.forEach(function(r,f){this.append(f,r)},this):Array.isArray(e)?e.forEach(function(r){this.append(r[0],r[1])},this):e&&Object.getOwnPropertyNames(e).forEach(function(r){this.append(r,e[r])},this)}t.prototype.append=function(e,r){e=c(e),r=y(r);var f=this.map[e];this.map[e]=f?f+", "+r:r},t.prototype.delete=function(e){delete this.map[c(e)]},t.prototype.get=function(e){return e=c(e),this.has(e)?this.map[e]:null},t.prototype.has=function(e){return this.map.hasOwnProperty(c(e))},t.prototype.set=function(e,r){this.map[c(e)]=y(r)},t.prototype.forEach=function(e,r){for(var f in this.map)this.map.hasOwnProperty(f)&&e.call(r,this.map[f],f,this)},t.prototype.keys=function(){var e=[];return this.forEach(function(r,f){e.push(f)}),b(e)},t.prototype.values=function(){var e=[];return this.forEach(function(r){e.push(r)}),b(e)},t.prototype.entries=function(){var e=[];return this.forEach(function(r,f){e.push([f,r])}),b(e)},n.iterable&&(t.prototype[Symbol.iterator]=t.prototype.entries);function l(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function m(e){return new Promise(function(r,f){e.onload=function(){r(e.result)},e.onerror=function(){f(e.error)}})}function G(e){var r=new FileReader,f=m(r);return r.readAsArrayBuffer(e),f}function L(e){var r=new FileReader,f=m(r);return r.readAsText(e),f}function z(e){for(var r=new Uint8Array(e),f=new Array(r.length),d=0;d<r.length;d++)f[d]=String.fromCharCode(r[d]);return f.join("")}function R(e){if(e.slice)return e.slice(0);var r=new Uint8Array(e.byteLength);return r.set(new Uint8Array(e)),r.buffer}function j(){return this.bodyUsed=!1,this._initBody=function(e){this.bodyUsed=this.bodyUsed,this._bodyInit=e,e?typeof e=="string"?this._bodyText=e:n.blob&&Blob.prototype.isPrototypeOf(e)?this._bodyBlob=e:n.formData&&FormData.prototype.isPrototypeOf(e)?this._bodyFormData=e:n.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)?this._bodyText=e.toString():n.arrayBuffer&&n.blob&&u(e)?(this._bodyArrayBuffer=R(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):n.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(e)||i(e))?this._bodyArrayBuffer=R(e):this._bodyText=e=Object.prototype.toString.call(e):this._bodyText="",this.headers.get("content-type")||(typeof e=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):n.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},n.blob&&(this.blob=function(){var e=l(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){if(this._bodyArrayBuffer){var e=l(this);return e||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}else return this.blob().then(G)}),this.text=function(){var e=l(this);if(e)return e;if(this._bodyBlob)return L(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(z(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},n.formData&&(this.formData=function(){return this.text().then($)}),this.json=function(){return this.text().then(JSON.parse)},this}var X=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function W(e){var r=e.toUpperCase();return X.indexOf(r)>-1?r:e}function T(e,r){if(!(this instanceof T))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');r=r||{};var f=r.body;if(e instanceof T){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,r.headers||(this.headers=new t(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,!f&&e._bodyInit!=null&&(f=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=r.credentials||this.credentials||"same-origin",(r.headers||!this.headers)&&(this.headers=new t(r.headers)),this.method=W(r.method||this.method||"GET"),this.mode=r.mode||this.mode||null,this.signal=r.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&f)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(f),(this.method==="GET"||this.method==="HEAD")&&(r.cache==="no-store"||r.cache==="no-cache")){var d=/([?&])_=[^&]*/;if(d.test(this.url))this.url=this.url.replace(d,"$1_="+new Date().getTime());else{var p=/\?/;this.url+=(p.test(this.url)?"&":"?")+"_="+new Date().getTime()}}}T.prototype.clone=function(){return new T(this,{body:this._bodyInit})};function $(e){var r=new FormData;return e.trim().split("&").forEach(function(f){if(f){var d=f.split("="),p=d.shift().replace(/\+/g," "),h=d.join("=").replace(/\+/g," ");r.append(decodeURIComponent(p),decodeURIComponent(h))}}),r}function J(e){var r=new t,f=e.replace(/\r?\n[\t ]+/g," ");return f.split("\r").map(function(d){return d.indexOf("\n")===0?d.substr(1,d.length):d}).forEach(function(d){var p=d.split(":"),h=p.shift().trim();if(h){var x=p.join(":").trim();r.append(h,x)}}),r}j.call(T.prototype);function g(e,r){if(!(this instanceof g))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');r||(r={}),this.type="default",this.status=r.status===void 0?200:r.status,this.ok=this.status>=200&&this.status<300,this.statusText=r.statusText===void 0?"":""+r.statusText,this.headers=new t(r.headers),this.url=r.url||"",this._initBody(e)}j.call(g.prototype),g.prototype.clone=function(){return new g(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new t(this.headers),url:this.url})},g.error=function(){var e=new g(null,{status:0,statusText:""});return e.type="error",e};var K=[301,302,303,307,308];g.redirect=function(e,r){if(K.indexOf(r)===-1)throw new RangeError("Invalid status code");return new g(null,{status:r,headers:{location:e}})},s.DOMException=o.DOMException;try{new s.DOMException}catch(e){s.DOMException=function(r,f){this.message=r,this.name=f;var d=Error(r);this.stack=d.stack},s.DOMException.prototype=Object.create(Error.prototype),s.DOMException.prototype.constructor=s.DOMException}function P(e,r){return new Promise(function(f,d){var p=new T(e,r);if(p.signal&&p.signal.aborted)return d(new s.DOMException("Aborted","AbortError"));var h=new XMLHttpRequest;function x(){h.abort()}h.onload=function(){var v={status:h.status,statusText:h.statusText,headers:J(h.getAllResponseHeaders()||"")};v.url="responseURL"in h?h.responseURL:v.headers.get("X-Request-URL");var O="response"in h?h.response:h.responseText;setTimeout(function(){f(new g(O,v))},0)},h.onerror=function(){setTimeout(function(){d(new TypeError("Network request failed"))},0)},h.ontimeout=function(){setTimeout(function(){d(new TypeError("Network request failed"))},0)},h.onabort=function(){setTimeout(function(){d(new s.DOMException("Aborted","AbortError"))},0)};function Q(v){try{return v===""&&o.location.href?o.location.href:v}catch(O){return v}}h.open(p.method,Q(p.url),!0),p.credentials==="include"?h.withCredentials=!0:p.credentials==="omit"&&(h.withCredentials=!1),"responseType"in h&&(n.blob?h.responseType="blob":n.arrayBuffer&&p.headers.get("Content-Type")&&p.headers.get("Content-Type").indexOf("application/octet-stream")!==-1&&(h.responseType="arraybuffer")),r&&typeof r.headers=="object"&&!(r.headers instanceof t)?Object.getOwnPropertyNames(r.headers).forEach(function(v){h.setRequestHeader(v,y(r.headers[v]))}):p.headers.forEach(function(v,O){h.setRequestHeader(O,v)}),p.signal&&(p.signal.addEventListener("abort",x),h.onreadystatechange=function(){h.readyState===4&&p.signal.removeEventListener("abort",x)}),h.send(typeof p._bodyInit=="undefined"?null:p._bodyInit)})}P.polyfill=!0,o.fetch||(o.fetch=P,o.Headers=t,o.Request=T,o.Response=g),s.Headers=t,s.Request=T,s.Response=g,s.fetch=P,Object.defineProperty(s,"__esModule",{value:!0})})});var V=_(function(se,I){M();I.exports=self.fetch.bind(self)});var C=_(function(E){"use strict";var Y=E&&E.__awaiter||function(s,o,n,u){function a(i){return i instanceof n?i:new n(function(c){c(i)})}return new(n||(n=Promise))(function(i,c){function y(l){try{t(u.next(l))}catch(m){c(m)}}function b(l){try{t(u.throw(l))}catch(m){c(m)}}function t(l){l.done?i(l.value):a(l.value).then(y,b)}t((u=u.apply(s,o||[])).next())})},Z=E&&E.__generator||function(s,o){var n={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},u,a,i,c;return c={next:y(0),throw:y(1),return:y(2)},typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function y(t){return function(l){return b([t,l])}}function b(t){if(u)throw new TypeError("Generator is already executing.");for(;n;)try{if(u=1,a&&(i=t[0]&2?a.return:t[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,t[1])).done)return i;switch(a=0,i&&(t=[t[0]&2,i.value]),t[0]){case 0:case 1:i=t;break;case 4:return n.label++,{value:t[1],done:!1};case 5:n.label++,a=t[1],t=[0];continue;case 7:t=n.ops.pop(),n.trys.pop();continue;default:if(i=n.trys,!(i=i.length>0&&i[i.length-1])&&(t[0]===6||t[0]===2)){n=0;continue}if(t[0]===3&&(!i||t[1]>i[0]&&t[1]<i[3])){n.label=t[1];break}if(t[0]===6&&n.label<i[1]){n.label=i[1],i=t;break}if(i&&n.label<i[2]){n.label=i[2],n.ops.push(t);break}i[2]&&n.ops.pop(),n.trys.pop();continue}t=o.call(s,n)}catch(l){t=[6,l],a=0}finally{u=i=0}if(t[0]&5)throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}};Object.defineProperty(E,"__esModule",{value:!0});E.Nodes=void 0;V();var ee=function(){function s(){this.nodeIndex=-1,this.committee=new Set,this.topology=[]}return s.prototype.init=function(o){return Y(this,void 0,void 0,function(){var n,u,a,i,c,y,b;return Z(this,function(t){switch(t.label){case 0:this.nodeIndex=-1,this.committee.clear(),this.topology=[],n=[],t.label=1;case 1:return t.trys.push([1,4,,5]),[4,fetch(o)];case 2:return u=t.sent(),[4,u.json()];case 3:return a=t.sent(),n=a,[3,5];case 4:throw i=t.sent(),new Error("exception in fetch(".concat(o,"): ").concat(i));case 5:for(c=0,y=n;c<y.length;c++)b=y[c],b.Healthy==="1"&&this.topology.push(b);if(this.topology.length===0)throw new Error("no healthy nodes retrieved");return[2]}})})},s.prototype.getNextNode=function(o){for(o===void 0&&(o=!0);;)return this.nodeIndex++,this.nodeIndex>=this.topology.length&&(this.nodeIndex=0),this.topology[this.nodeIndex]},s.prototype.getRandomNode=function(o){o===void 0&&(o=!0);var n=Math.floor(Math.random()*this.topology.length);return this.topology[n]},s}();E.Nodes=ee});var q=_(function(w){"use strict";var A=w&&w.__awaiter||function(s,o,n,u){function a(i){return i instanceof n?i:new n(function(c){c(i)})}return new(n||(n=Promise))(function(i,c){function y(l){try{t(u.next(l))}catch(m){c(m)}}function b(l){try{t(u.throw(l))}catch(m){c(m)}}function t(l){l.done?i(l.value):a(l.value).then(y,b)}t((u=u.apply(s,o||[])).next())})},B=w&&w.__generator||function(s,o){var n={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},u,a,i,c;return c={next:y(0),throw:y(1),return:y(2)},typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function y(t){return function(l){return b([t,l])}}function b(t){if(u)throw new TypeError("Generator is already executing.");for(;n;)try{if(u=1,a&&(i=t[0]&2?a.return:t[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,t[1])).done)return i;switch(a=0,i&&(t=[t[0]&2,i.value]),t[0]){case 0:case 1:i=t;break;case 4:return n.label++,{value:t[1],done:!1};case 5:n.label++,a=t[1],t=[0];continue;case 7:t=n.ops.pop(),n.trys.pop();continue;default:if(i=n.trys,!(i=i.length>0&&i[i.length-1])&&(t[0]===6||t[0]===2)){n=0;continue}if(t[0]===3&&(!i||t[1]>i[0]&&t[1]<i[3])){n.label=t[1];break}if(t[0]===6&&n.label<i[1]){n.label=i[1],i=t;break}if(i&&n.label<i[2]){n.label=i[2],n.ops.push(t);break}i[2]&&n.ops.pop(),n.trys.pop();continue}t=o.call(s,n)}catch(l){t=[6,l],a=0}finally{u=i=0}if(t[0]&5)throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}};Object.defineProperty(w,"__esModule",{value:!0});w.getTonApiV4Endpoint=w.getTonApiV4Endpoints=w.getTonCenterV2Endpoint=w.getTonCenterV2Endpoints=w.Gateway=void 0;var te=C(),U=function(){function s(){this.host="ton.gateway.orbs.network",this.urlVersion=1,this.formatSuffix="",this.nodes=new te.Nodes}return s.prototype.init=function(){return A(this,void 0,void 0,function(){return B(this,function(o){switch(o.label){case 0:return[4,this.nodes.init("https://".concat(this.host,"/nodes"))];case 1:return o.sent(),[2]}})})},s.prototype.buildUrls=function(o,n,u){u||(u="");for(var a=[],i=this.nodes.topology.length,c=0;c<i;++c){var y=this.nodes.getNextNode(),b="https://".concat(this.host,"/").concat(y.Name,"/").concat(this.urlVersion,"/").concat(o,"/").concat(n,"/").concat(u);a.push(b)}return a},s}();w.Gateway=U;function N(s,o){return A(this,void 0,void 0,function(){var n,u;return B(this,function(a){switch(a.label){case 0:return s||(s="mainnet"),o||(o="jsonRPC"),n=new U,[4,n.init()];case 1:return a.sent(),u=n.buildUrls(s,"toncenter-api-v2",o),[2,u]}})})}w.getTonCenterV2Endpoints=N;function re(s,o){return A(this,void 0,void 0,function(){var n,u;return B(this,function(a){switch(a.label){case 0:return[4,N(s,o)];case 1:return n=a.sent(),u=Math.floor(Math.random()*n.length),[2,n[u]]}})})}w.getTonCenterV2Endpoint=re;function F(){return A(this,void 0,void 0,function(){var s,o;return B(this,function(n){switch(n.label){case 0:return s=new U,[4,s.init()];case 1:return n.sent(),o=s.buildUrls("mainnet","ton-api-v4"),[2,o]}})})}w.getTonApiV4Endpoints=F;function ne(){return A(this,void 0,void 0,function(){var s,o;return B(this,function(n){switch(n.label){case 0:return[4,F()];case 1:return s=n.sent(),o=Math.floor(Math.random()*s.length),[2,s[o]]}})})}w.getTonApiV4Endpoint=ne});var ie=_(function(k){Object.defineProperty(k,"__esModule",{value:!0});var H=q();window.TonGateway={create:function(){return new H.Gateway},getTonCenterV2Endpoint:H.getTonCenterV2Endpoint}});ie();})();
